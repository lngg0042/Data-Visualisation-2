<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Malaysia Transportation & Logistic Industry</title>

  <!-- Vega & Vega-Lite -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background: white;
      color: #222;
      line-height: 1.7;
    }

    /* HEADER */
    header {
      background: linear-gradient(120deg, #000 0%, #333 100%);
      color: white;
      text-align: center;
      padding: 50px 20px 40px;
    }
    
    header .subtitle { 
      margin-top: 10px; 
      font-size: 18px; 
      font-weight: 400; 
      color: white; 
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
    }

    header h1 {
      font-family: 'Merriweather', serif;
      font-size: 40px;
      font-weight: 700;
      margin: 0;
      letter-spacing: 0.3px;
    }

    header p {
      max-width: 700px;
      margin: 18px auto 0;
      font-size: 17px;
      color: #e5e5e5;
      font-family: 'Inter', sans-serif;
      line-height: 1.5;
    }

    /* NAVIGATION */
    nav {
      background: #000;
      text-align: center;
      padding: 10px;
      position: sticky;
      top: 0;
      z-index: 20;
    }

    nav a {
      color: #fff;
      text-decoration: none;
      margin: 0 12px;
      padding: 6px 12px;
      border-radius: 18px;
      transition: background 0.3s;
      font-weight: 500;
      font-size: 15px;
    }

    nav a:hover, nav a.active {
      background: #333;
    }

    /* MAIN CONTENT */
    main {
      max-width: 950px;
      margin: 20px auto;
      padding: 0 22px;
    }
        
    main section:first-of-type {
      padding-top: 20px; /* less padding at top for first section */
    }

    section {
      margin-bottom: 50px;
      padding: 40px 20px;
      position: relative;
    }

    /* Subtle divider between sections */
    section + section::before {
      content: "";
      display: block;
      height: 1px;
      background-color: #847f7f;
      width: 100%;
      position: absolute;
      top: 0;
      left: 0;
    }

    h2 {
      font-family: 'Merriweather', serif;
      color: #111;
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 16px;
      position: relative;
      padding-bottom: 8px;
    }

    .story {
      color: #444;
      margin-bottom: 12px;
      font-size: 15.5px;
      line-height: 1.55;
    }

    .insights {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 14px;
    }

    .insight-card {
      background: #f3f5ff;
      padding: 12px 16px;
      border-left: 4px solid #000;
      border-radius: 8px;
      flex: 1;
      min-width: 160px;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      transition: transform 0.3s;
    }

    .insight-card:hover {
      transform: translateY(-3px);
    }

    .instruction {
      font-style: italic;
      color: #555;
      margin-bottom: 10px;
      display: block;
      font-size: 0.9rem;
    }

    /* BACK TO TOP BUTTON */
    #backToTop {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: none;
      background: #000;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      font-size: 18px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      transition: background 0.3s;
    }

    #backToTop:hover {
      background: #333;
    }

    footer {
      background: #000;
      color: white;
      text-align: center;
      padding: 18px 20px;
      font-size: 13.5px;
      letter-spacing: 0.3px;
    }

    footer a {
      color: white;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      header h1 { font-size: 32px; }
      header p { font-size: 15px; }
      h2 { font-size: 22px; }
      main { padding: 0 16px; }
    }

    /* === Align Spec for charts === */
    #employment-chart,
    #establishment-chart,
    #assets-chart,
    #grossoutput-chart,
    #valueadded-chart,
    #airports-chart {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #employment-chart .vl-binding,
    #establishment-chart .vl-binding,
    #assets-chart .vl-binding,
    #grossoutput-chart .vl-binding,
    #valueadded-chart .vl-binding,
    #airports-chart .vl-binding {
      order: 2;
      margin-top: 10px;
    }

    #employment-chart .vl-view,
    #establishment-chart .vl-view,
    #assets-chart .vl-view,
    #grossoutput-chart .vl-view,
    #valueadded-chart .vl-view,
    #airports-chart .vl-view {
      order: 1;
    }
  </style>
</head>
<body>

  <header>
    <h1>Malaysia Transportation & Logistic Industry</h1>
    <p class="subtitle">
      Malaysia’s transportation and logistics (T&L) sector continues to evolve rapidly — 
      driven by e-commerce, infrastructure growth, and digital transformation that strengthen national connectivity.
    </p>
  </header>

  <nav>
    <a href="#valueadded">Value Added</a>
    <a href="#grossoutput">Gross Output</a>
    <a href="#airports">Airports</a>
    <a href="#assets">Assets</a>
    <a href="#establishment">Establishments</a>
    <a href="#employment">Employment</a>
  </nav>

  <main>
    <section id="valueadded">
      <h2>Value Added by State</h2>
      <p class="story">
        <b>Selangor</b> leads Malaysia in transportation value added, followed by Kuala Lumpur, Johor, and Sarawak — 
        together contributing over <b>RM 31.9M</b>. These states drive logistics excellence and national economic growth.
      </p>
      <div class="insights">
        <div class="insight-card"><b>Highest:</b> Selangor (RM 25.25M)</div>
        <div class="insight-card"><b>Lowest:</b> Perlis (RM 76K)</div>
      </div>
      <div id="valueadded-chart"></div>
    </section>

    <section id="grossoutput">
      <h2>Gross Output Density</h2>
      <p class="story">
         <b>Selangor</b> and <b>Melaka</b> demonstrate the highest output per km², reflecting efficient industrial clustering 
        and optimized land use in logistics zones.
      </p>
      <div id="grossoutput-chart"></div>
    </section>

    <section id="airports">
      <h2>Airports in Malaysia</h2>
      <p class="story">
        <b>Kuala Lumpur International Airport (KLIA)</b> remains Malaysia’s main aviation hub, 
        while <b>Sabah</b> and <b>Sarawak</b> maintain the highest number of airports due to regional accessibility needs.
      </p>
      <p class="instruction">[Click the legend points to view the number of airports by type and state.]</p>
      <div id="airports-chart"></div>
    </section>

    <section id="assets">
      <h2>Distribution of Transportation Assets</h2>
      <p class="story">
        From <b>2010</b> to <b>2014</b>, Selangor surpassed Kuala Lumpur in asset value, solidifying its status 
        as Malaysia’s central logistics hub with strong industrial growth.
      </p>
      <p class="instruction">[Please select a year to view the distribution of transportation assets.]</p>
      <div id="assets-chart"></div>
    </section>

    <section id="establishment">
      <h2>Transport Establishments</h2>
      <p class="story">
        <b>Selangor</b>, <b>Johor</b>, and <b>Sarawak</b> have the most transport establishments, showcasing 
        high business activity and regional logistics capacity.
      </p>
      <div id="establishment-chart"></div>
    </section>

    <section id="employment">
      <h2>Employment Growth</h2>
      <p class="story">
        After a slight dip in 2014, employment in the sector rebounded by <b>2017</b> — 
        growing nearly <b>50%</b> from 2010, reflecting strong recovery and workforce expansion.
      </p>
      <p class="instruction">[Please select a metric type to compare results by Employment Index or Total Persons Engaged.]</p>
      <div id="employment-chart"></div>
    </section>
  </main>

  <button id="backToTop">↑</button>

  <footer>
    Visualization by <b>Ng Li Xian</b>.<br>
    Data: 
    <a href="https://data.gov.my" target="_blank">data.gov.my</a> | 
    <a href="https://data.humdata.org" target="_blank">HDX</a> | 
    <a href="https://simplemaps.com" target="_blank">SimpleMaps</a>
  </footer>

  <script>
    const charts = [
      { id: '#valueadded-chart', file: './choropleth-value.json' },
      { id: '#grossoutput-chart', file: './choropleth-gross.json' },
      { id: '#airports-chart', file: './airport-map.json' },
      { id: '#assets-chart', file: './bar-chart-assets.json' },
      { id: '#establishment-chart', file: './proportional.json' },
      { id: '#employment-chart', file: './lolipop-employ.json' }
    ];

    charts.forEach(chart => {
      vegaEmbed(chart.id, chart.file, { actions: false, renderer: "canvas" })
        .then(res => window.addEventListener('resize', () => res.view.resize().run()))
        .catch(console.error);
    });

    const backToTop = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      backToTop.style.display = window.scrollY > 300 ? 'block' : 'none';
    });
    backToTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
  </script>
</body>
</html>
